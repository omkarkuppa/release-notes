*********************************************************************************
Commit: d505a674a376522414216e523ca54fd791e2f67e 
*********************************************************************************

[CPU]

  [CFL][PSIRT]Insecure handling of "CpuSmm" NVRAM variable - Part 2
  
  [Issue/Feature Description]
  A security researcher reported a weakness with the NVRAM variable "CpuSmm".
  UEFI implementations do not correctly protect and validate information contained in the 'CpuSmm' UEFI variable.
  
  This variable can be overwritten using operating system APIs or UEFI shell.
  By tampering with this variable, SW attacker can disable SMM protection mechanisms (e.g., CpuSmmCodeAccessCheck).
  
  [Resolution]
  Add dependency gDxeCpuPolicyProtocolGuid into SmmCpuFeaturesLib.inf because it consumes the protocol.
  
  Package/Module: CannonLakeSiliconPkg/SmmCpuFeaturesLib
  
  [Impacted Platform]
  CFL
  
  Hsd-es-id: 15011592487
  Change-Id: I19c0d58a32c8aca8bcc6c02e3be8242fbb1915a9
  Original commit hash: 16b20c303fc2a948571faa77f9a3fd7d51dbbab5
  
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.inf
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: psirt
  --Commit Message Contains Key Word: security

*********************************************************************************
Commit: a46f48d2a34dc56c0d6aaeb6c6d4088246a29868 
*********************************************************************************

[PlatformPkg], [CPU]

  [CFL][PSIRT]Insecure handling of "CpuSmm" NVRAM variable
  
  [Issue/Feature Description]
  A security researcher reported a weakness with the NVRAM variable "CpuSmm".
  UEFI implementations do not correctly protect and validate information contained in the 'CpuSmm' UEFI variable.
  
  This variable can be overwritten using operating system APIs or UEFI shell.
  By tampering with this variable, SW attacker can disable SMM protection mechanisms (e.g., CpuSmmCodeAccessCheck).
  
  [Resolution]
  Remove NVRAM variable CpuSmm entirely to avoid variable been tampered.
  Use CpuSetup to contain all CPU setup options.
  Use CpuPolicyProtocol to contain policies consumed by CPU RC.
  
  Package/Module: CannonLakePlatSamplePkg/PolicyInitDxe
  
  [Impacted Platform]
  CFL
  
  Hsd-es-id: 15011592487
  Change-Id: I7253a5fc254ca0b1226062ead46c8724ee435c8a
  Original commit hash: fac9ffb53628ff2410522be0b9a999ce2a6a778a
  
  CannonLakePlatSamplePkg/Include/CpuSmm.h
  CannonLakePlatSamplePkg/Include/SetupVariable.h
  CannonLakePlatSamplePkg/Library/DxePolicyUpdateLib/DxeCpuPolicyUpdate.c
  CannonLakePlatSamplePkg/PlatformInit/PolicyInitDxe/PolicyInitDxe.c
  CannonLakePlatSamplePkg/PlatformInit/PolicyInitDxe/PolicyInitDxe.inf
  CannonLakePlatSamplePkg/PlatformPkg.dec
  CannonLakePlatSamplePkg/PlatformPkg.dsc
  CannonLakePlatSamplePkg/Setup/Advanced.vfr
  CannonLakePlatSamplePkg/Setup/CpuSetup.hfr
  CannonLakePlatSamplePkg/Setup/DebugSetup.hfr
  CannonLakePlatSamplePkg/Setup/HiiConfigAccess.c
  CannonLakePlatSamplePkg/Setup/InitStringList.h
  CannonLakePlatSamplePkg/Setup/SetupId.h
  CannonLakeSiliconPkg/Cpu/Include/Protocol/CpuPolicyProtocol.h
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeatures.h
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.c
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.inf
  CannonLakeSiliconPkg/SiPkg.dec
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: psirt
  --Commit Message Contains Key Word: security

################################################################################

Report Summary: Backstop found 2 suspect commits for review 

Warnings Found:
  Commit: d505a67    --Commit Message Contains Key Word: psirt
  Commit: d505a67    --Commit Message Contains Key Word: security
  Commit: a46f48d    --Commit Message Contains Key Word: psirt
  Commit: a46f48d    --Commit Message Contains Key Word: security
