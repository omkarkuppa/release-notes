================================================================================ 
Commit: cedee74c7690fc301edc76415f99b290d65a8aee 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:37 2020 -0700 
-------------------------------------------------------------------------------- 
Update BIOS ID to 3313.02

Hsd-es-id: N/A
Original commit date: Wed Jul 29 14:49:33 2020 -0700
Change-Id: I90e93ff75813a87995723176b76364d8d5a68307
Original commit hash: 5296c026421d0c722803a3098ec8ed0a3a1e4434

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 3aeec358b826eae5784027a5c037644895528674 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:31 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInit/Tgl: [TGL][MRC] Update MrcVersion.h and ReleaseNotes to master 1.0.0.0

Updating MrcVersion.h and ReleaseNotes

Hsd-es-id: N/A
Original commit date: Wed Jul 29 10:14:29 2020 -0700
Original commit hash: d66ac2921c0e5cf9199442ce0162e4b44b638732

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 165d74cf744630a21c95736aa2d3249ef97d1e0e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:25 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Mon Jul 27 23:36:26 2020 +0000
Original commit date: Mon Jul 27 23:36:26 2020 +0000
Original commit hash: 9907f10ddd1850afdd1cf91142fba06c582019de

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 89e3f0b954a5ea8822989fbb5014a71c7d1bcdeb 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:19 2020 -0700 
-------------------------------------------------------------------------------- 
Revert "ClientOneSiliconPkg/MemoryInit/Tgl: [TGL-B2][LPDDR4]  (Additional selextref and ldo_vrefsel values ) IOM stuck at MUX_AGENT_ALT_MODE_REQ stage 4 on connect after S4 exit  due to ddrio command timeout"

This reverts commit d881a433090421cb518541d3f635b0a4f8e27b08.

W/A is no longer needed

Hsd-es-id: 14011949739
Original commit date: Fri Jul 24 09:31:57 2020 -0700
Change-Id: Ice9460affc0b3f556ab2f73e20de9f908ea5d3b9
Original commit hash: 077c7933f005a24d3558fb39b89e4bc0c8377143

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcMcConfiguration.c

================================================================================ 
Commit: e6b2570c3d31d0c62fb071ac74c473e6b35f2814 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:15 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInit/Tgl: [TGL][MRC] Update MrcVersion.h and ReleaseNotes to 0.9.9.0

Updating MrcVersion.h and ReleaseNotes

Hsd-es-id: N/A
Original commit date: Mon Jul 27 14:46:24 2020 +0800
Change-Id: Id19e20ac06034733351f21650ac816e77083d328
Original commit hash: 043c7b540ad18582a601dc2e79d0c664de082ae9

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 2a306fbe39d9af4a0dc12c783b35db97a23cad6f 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:11 2020 -0700 
-------------------------------------------------------------------------------- 
TigerLakePlatSamplePkg: Platform hangs when we connect to secured network and go to http boot for file downloading.

Check UndiTelemetryVersionData before FreePool.

Hsd-es-id: 16011447632
Original commit date: Wed Jul 29 13:49:22 2020 +0800
Change-Id: I0d41cbec044e4411a35d68eb2e925377c6dbfad9
Original commit hash: 70c22e586200351c0e392874640b89f5af9e04d5

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/Telemetry/UndiFirmwareVersionDxe/UndiFirmwareVersionDxe.c

================================================================================ 
Commit: a53ba6ad3f814a2cf86035617f55117c6432dcd5 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:08 2020 -0700 
-------------------------------------------------------------------------------- 
Update BIOS ID to 3313.01

Hsd-es-id: N/A
Original commit date: Wed Jul 29 11:35:14 2020 -0700
Change-Id: I89a91c3e077ab4087442e89e3e3afb4ba346f2d6
Original commit hash: ac2dd464bb6c13cbe1d0630ca9cd296c321504ae

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: b170a7af96e364439dd76fabbe06e64b34dcf88d 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:05 2020 -0700 
-------------------------------------------------------------------------------- 
Unexpected Shutdown during Idle Display-on testing

Retention mode will not be supported on TGP silicon until C0 stepping
Updating the programming of VCCIN_AUX_CFG1 register based on design recommendation

Hsd-es-id: 22011150697
Original commit date: Tue Jul 28 15:54:04 2020 -0700
Change-Id: I0c191524b46333b9090febc7618392309728be9a
Original commit hash: 9cdb6b3b54963bc919e99a01d37d8ba70af96f6c

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/Pmc/LibraryPrivate/PeiDxeSmmPmcPrivateLib/PeiPmcPrivateLibFivr.c

================================================================================ 
Commit: d72237323cd726e5bb3e26e1f37e60e3dd40dcaa 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:48:02 2020 -0700 
-------------------------------------------------------------------------------- 
Update new microcode patch for B0 (uCode+Punit) Production Patch 0x52

Hsd-es-id: 22011197873
Original commit date: Wed Jul 29 11:02:02 2020 -0700
Change-Id: Ifa512aabae87c81d89f68cac144f253ece10559a
Original commit hash: 1b05d5fe760e56e3dc4409a50de56d290c12ecfa

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BoardPkg.fdf

================================================================================ 
Commit: 5119d05e61c376e5d878712b289f0c8332d9507e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:58 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Wed Jul 29 10:37:38 2020 -0700
Change-Id: Icecddeaccfc5bb61ff8ac527ae0fc841bf2c14d4
Original commit hash: 5c3baa1b57d64a298f9759d9221a7850e800eb72

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 9fe3ffd65c36c65f34cd51ef404ec12f095ba082 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:55 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3313_00

Hsd-es-id: no sighting
Original commit date: Wed Jul 29 10:37:18 2020 -0700
Change-Id: I4fd8b53df794e403fd438bff14d9ae267e8dc182
Original commit hash: 84413311abaf1e11c2470cf9e5174266d2ad51b6

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 3392518be948840f486048b87a5d9a5ddaa5f53e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:48 2020 -0700 
-------------------------------------------------------------------------------- 
Update BIOS ID to 3312.01

Hsd-es-id: N/A
Original commit date: Tue Jul 28 13:18:22 2020 -0700
Change-Id: Ia81628be47475db0edabb647af134771a5b8f340
Original commit hash: d7af5bfa9424ea6d609abeaad3552cd1774e89e3

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 75838c97e37e80f3a3289b97e59c7153840166a9 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:45 2020 -0700 
-------------------------------------------------------------------------------- 
PECI GPIO (pad_cfg_dw1_peci.iosstate) io_standby state is programmed incorrectly

Board strap is readable by EC only determines PECI vs eSPI. EC has to send
messages for temperature and in ModernStandby the PECI GPIO pin is off in
current implementation. This change will ensure the GPIO is always on by
programming the correct IOStandBy state. Power-impact is negligible.

Change: Program pch.gpio.com3.sb.pad_cfg_dw1_peci.iosstate = 0xf

Hsd-es-id: 22011185410
Original commit date: Thu Jul 23 06:48:04 2020 -0700
Change-Id: Ic31b51ffea7807fb54372fc61750f4b6f69cfb16
Original commit hash: 62aa71a8a8ab0e8ae260bf1e1d1543eff7541aa0

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/Gpio/LibraryPrivate/PeiDxeSmmGpioPrivateLib/GpioPrivateLibVer2.c

================================================================================ 
Commit: 8a7e7a8bebce85b69dc3e4a0fe265ea051becf54 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:42 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg: xHCI programming updates

Changed SSCTGE value to 0x8 for USB IP v18 PCH controllers.
Added Rx Termination Control override for V18 programs in DAP.

Hsd-es-id: 18012387503
Original commit date: Mon Jul 27 15:11:02 2020 +0200
Change-Id: I26b833e50f8944685969e08effd25c9dbf90bf79
Original commit hash: b109d90203d6f2d86b16d6b4b41b646d7ead1ea3

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/Include/Register/UsbRegs.h
ClientOneSiliconPkg/IpBlock/Usb/LibraryPrivate/PeiUsbHostControllerInitLib/XhciInit.c

================================================================================ 
Commit: e98be32b2dc4f97a907f00eaf86485e14b354f1c 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:39 2020 -0700 
-------------------------------------------------------------------------------- 
BoardPkg: S0ix Substates are not POR for TGL-H platform.

Disable all S0ix sub-states in BIOS for TGL-H platform. Also gray them out in BIOS PCH-IO COnfig BIOS screen.

Hsd-es-id: 14012121654
Original commit date: Thu Jul 23 11:57:34 2020 -0700
Change-Id: Ib49f60b72034c1ae882dd535c2764849179ffa29
Original commit hash: b41b944ac446016c936b579b1f0de92991ccabdb

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/TigerLakeHBoards/Include/TigerLakeHBoardConfigPatchTable.h
TigerLakePlatSamplePkg/Setup/PchSetup.hfr

================================================================================ 
Commit: 21cfbe05fa5bdcc209f30a374964fa64235da0b2 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:35 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Tue Jul 28 12:26:37 2020 -0700
Change-Id: If9bb1e8034d23010ff12b144dd069cba3e7fc015
Original commit hash: d3e12f0d5ccb52ff82cac4d8f3b8c5ad2407b22e

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: b47532a27a376c3212cc4a4342cbc30156981ead 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:32 2020 -0700 
-------------------------------------------------------------------------------- 
MeExtMeasurement: [TGL] Fix for String IntelCSxEEvent01 is missing when CSME Disabled

Fix for Event signing string IntelCSxEEvent01 is missing
in the TBS Logs when CSME FW is disabled.

Hsd-es-id: 16011496931
Original commit date: Sat Jul 25 12:26:39 2020 +0530
Change-Id: I17cf3673016425fb3c033858c65667f697481fc6
Original commit hash: 7377f2991e33ba2e8c5ae2e2dba8566fb3e74133

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/Features/Me/MeExtMeasurement/Dxe/MeExtMeasurement.c

================================================================================ 
Commit: 0706d532dee5f2bf9e1abc6255440e9eb38a13ec 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:29 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3312_00

Hsd-es-id: no sighting
Original commit date: Tue Jul 28 09:23:48 2020 -0700
Change-Id: I8ee9b07b424303d4850ea11740a7a4d3735a03ff
Original commit hash: 755b73f2b745c117ff74e174db1ec71115a50160

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 61d81eb6d12eb2295e41a562797cfe1bdbf5bf5e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:26 2020 -0700 
-------------------------------------------------------------------------------- 
[TGLH-P0][PO] USB 3.1 Gen2 Tx siv 10G eye failing

Hsd-es-id: 14011781076
Original commit date: Thu Jul 2 15:33:53 2020 -0700
Change-Id: Ia9a4054d710557c3f445e3ca95194563cf5986c0
Original commit hash: 748e7960e6af297e736c1b3b72904d6489c2a668

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/Usb/LibraryPrivate/PeiUsbHostControllerInitLib/XhciInit.c

================================================================================ 
Commit: a0a66e5a582f3109a06cd8e12da1d789500c8063 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:22 2020 -0700 
-------------------------------------------------------------------------------- 
Update new microcode patch for B0 (uCode+Punit) Production Patch 0x50

Hsd-es-id: 14012118812
Original commit date: Mon Jul 27 11:58:22 2020 -0700
Change-Id: Icfde736e0492cadfbc3af64356cf5a594aedcacf
Original commit hash: 83aa044ea1a3203c97a3a46aed426b0f02251323

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BoardPkg.fdf

================================================================================ 
Commit: 3439c098304f1c0cfb1814797a5efb64a558cc71 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:19 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Mon Jul 27 11:48:18 2020 -0700
Change-Id: Ib0af60b2844e3d09b89563f6398e80735aafb215
Original commit hash: 3a72ff4db7d27be57628e256be935296c841620d

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: f78179d4f8f7d1a725ac1a24127862fe98b11b3e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:16 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3311_01

Hsd-es-id: no sighting
Original commit date: Mon Jul 27 11:47:41 2020 -0700
Change-Id: Iddf6ec1bc688836486546c9f55c3fb306d38c04d
Original commit hash: 133700ef0b0e0380de3d2027ef59e1dd524b4f74

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 15e9e98f6889023442cc748a9cd108f54cd98723 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:13 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update TGLMaster BIOS Version to 3311_00

Hsd-es-id: no sighting
Original commit date: Mon Jul 27 09:08:45 2020 -0700
Change-Id: I5f8e649cc0bf763a31c160fbd9a1e1d4b5398776
Original commit hash: a68150b6293e389ae38bbf56c01fb540fa5733dd

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 794fc1b79ad57583d795b082c9815bd463f392bc 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:10 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Sun Jul 26 11:37:44 2020 -0700
Change-Id: Id656177578b9f2050469e506b8adc2966c2502e8
Original commit hash: d9de1cd5db9926a725be8c6eabcdfb751ea65cfc

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 1851bd4403efb07aa8c0d71bb0cfa82aea5d9c94 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:07 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3307_00

Hsd-es-id: no sighting
Original commit date: Sun Jul 26 09:09:01 2020 -0700
Change-Id: If2d25fd116bfa0861be6246647f8bf833c8c79c2
Original commit hash: 80dd98c7d662bc83ff10fe51ae2da2144086d77d

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 1229c3a02003c5bdeb9ffab050533a4784f88867 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:47:03 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInit/Tgl: [TGL][MRC] Update MrcVersion.h and ReleaseNotes to master 0.9.8.0

Updating MrcVersion.h and ReleaseNotes

Hsd-es-id: N/A
Original commit date: Sat Jul 25 23:03:03 2020 -0700
Change-Id: I11d55fbaa7879acb76fac696ebc05befdb324a53
Original commit hash: 0fb4d0307fc92d8360c574e96f2ff93d2e399233

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: cc73b3aacff561ccf5216b3ba789902cc0e33c21 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:59 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Sun Jul 26 06:49:57 2020 +0000
Original commit date: Sun Jul 26 06:49:57 2020 +0000
Original commit hash: 321e4eeb48da9a99eb6ffa54b9120207b42d506b

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: f8193ea5c8291b80d376c2bc29330cf426139380 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:54 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInt/Tgl: [TGL][UP4] Please change SAGV points for UP4 LP4 to 2133G2->3200G2->4267G2->4267G2

[Resolution]
Update TGL-Y LP4 SAGV points to 2133G2, 3200G2, 4267G2, 4267G2

[Impacted Platform]
Only TGL-Y

Hsd-es-id: 14012111971
Original commit date: Sat Jul 25 23:35:24 2020 -0700
Change-Id: I2e10ba8a8cfc690ab0d230920e7228f80fe57456
Original commit hash: 1d3d8745edac185ca453a3b26e135ffebd107908

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Api/MrcGeneral.c

================================================================================ 
Commit: 484cadb93ebcf6004e6edf9419cecfccc3fe1287 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:49 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Sun Jul 26 05:53:43 2020 +0000
Original commit date: Sun Jul 26 05:53:43 2020 +0000
Original commit hash: 4856b0f4a38efcf16d8d46770cedadbbea8a0969

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 964c93a3db6186fefaaa223414574755e1333847 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:45 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInit/Tgl: [TGL-U][DDR4] Seeing low RcvEn margins on some G1 frequencies

[Issue/Feature Description]
Seeing low RcvEn margins on some G1 frequencies

[Resolution]
Perform RecEn re-centering at the end of training for DDR4 similar to the one existing for LP4x

[Impacted Platform]
All TGL

[internal-only]:

Hsd-es-id: 22011133598
Original commit date: Wed Jul 8 15:48:32 2020 -0700
Change-Id: I41b2e693c928925a8fc69edba69dc3d033ac57d9
Original commit hash: 7b85da1d5f2b91408de4c3d78a555e4e269019e0

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Api/MrcStartMemoryConfiguration.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/ReadTraining/MrcReadReceiveEnable.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCrosser.c

================================================================================ 
Commit: aab678d8ffcbc69ff0c4e3e9d167b1b112bc70e6 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:40 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Sun Jul 26 05:42:06 2020 +0000
Original commit date: Sun Jul 26 05:42:06 2020 +0000
Original commit hash: 6b335c6bda3f8c74295dc3942cc5c45a140ad1ae

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: fdb665084844701c147e529ba8b2d117c56f7b6d 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:37 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/IpBlock/MemoryInit: Updates to Write Leveling adjusting Wr/En Pointer

Issue:
  System is failing when RdEn is set to 0.

Change:
  Reduce the PI Reserved in Write Leveling Flyby for DDR4 2133 G2 to 64.
  Removed +1 off of MAX_DEC math in Gear2 as we only ever program 15 which is 30tCK.
  Added algorithm debug printing for Write Leveling Flyby and disabled the algo prints.
  Change the CLK PI shift in LCT for DDR4 2133 G2 to 64.
  Updated NEM code for MiniBIOS

Hsd-es-id: 14012112044
Original commit date: Tue Jul 14 14:42:48 2020 -0700
Change-Id: Id7b9baed6618ef6bb847fdff9585f9aafbdbb07a
Original commit hash: 23d1248e2466193c1fb6552ccf5e48c9acdec714

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Api/MrcDebugPrint.h
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Chip/MrcChipApi.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCommandTraining.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/WriteTraining/MrcWriteLeveling.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/WriteTraining/MrcWriteLeveling.h
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/MiniBios/CPU/SRC32/crcstart.asm

================================================================================ 
Commit: 9653f4cfae12258294f5107559b216e09ad2d5c4 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:31 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Wed Jul 22 18:46:36 2020 +0000
Original commit date: Wed Jul 22 18:46:36 2020 +0000
Original commit hash: 7b2ee8b4247dc337e7101a5c135e26d42b0bff7e

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: c3626c064f44976709cb0f18c53b05acc774c262 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:26 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/MemoryInit:[TGL][MRC][LP5] Add Channel and Rank info when TxVref saturates during RMTPERBIT

On some platforms where MRC doesnt see an edge on one side, RMTPERBIT should stop sweeping after the minimum or maximum limit but  it goes one over. This needs to be debugged but currently there is no designated station to reproduce this problem. Its being tracked on another sighting central ticket. EV wanted to print channel and rank information if TxVref saturates.

Hsd-es-id: 22011135771
Original commit date: Thu Jul 16 11:37:36 2020 -0700
Change-Id: Idfe99e66acf6179eb345e72b6973d2e8b8b95d7b
Original commit hash: 3cf74bcd18895eba70cc650302cfde7f7d551cda

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/MemoryTypes/MrcLpddr5.c

================================================================================ 
Commit: 557bdbda1b7b05d334d91b3bf8347a118bc877f7 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:21 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Wed Jul 22 17:34:27 2020 +0000
Original commit date: Wed Jul 22 17:34:27 2020 +0000
Original commit hash: 270c57d8366f66845bd278a08f0940dbdc41c3a1

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: b8777ca9cd5e82487dcbeca00e9976e315eafb89 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:17 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl:[TGL][MRC][LP5] Saturating centered TxVref value after Write Voltage centering
Issue:
  TxVref voltage may exceed 225mV which is beyond maximum value for frequencies higher than 1600
Fix:
  After Woltage Centering training is done we add SaturateWrV function. It updates centered TxVref offset value.
  We compare this value with maximum offset and if it exceeds set this centered value to maximum.
  NOTE: This change is not affecting the TxVref sweep range of during the training.

Hsd-es-id: 22011133968
Original commit date: Mon Jun 15 15:55:12 2020 -0700
Change-Id: I6e0d5ecfb0876ad9b0157e845ffe075a859ece5b
Original commit hash: f7b83962561cd449292e8642c685b4a07341fc8c

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/MemoryTypes/MrcLpddr5.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/MemoryTypes/MrcLpddr5.h
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCommon.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/WriteTraining/MrcWriteDqDqs.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/WriteTraining/MrcWriteDqDqs.h

================================================================================ 
Commit: 95186aa23712e48fd23171d3ece0cc44ac94f3b3 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:12 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 20:24:19 2020 +0000
Original commit date: Tue Jul 21 20:24:19 2020 +0000
Original commit hash: fe715b54a2820b742c972984e92f29958718bb72

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 1201e8cafd75c084416053b21d885b140728171e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:07 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/MemoryInit:[TGL][MRC][LP5] Write Voltage Centering 2D is updated to train and save results per rank.

History
This algorithm used to consider the eye width and eye height of rank0, perform 2D sweep on rank0, set all TxDq and TxVref as per rank0 results and save the margin result for all populated ranks. It used to be this way because in DDR3 and LP3 TxVref used to be a pin on the DRAM. So it cant be different per rank. A separate function was written for DDR4 to account for TxVref per device. However LP still used old code even though both LP4 and LP5 have TxVref set in MRs and MRs are per rank. Its too late to change the shared algo for LP4 therefore a new function is created for LP5.

Issue
LP5 TxVref is fairly tight and at 5400 any margin loss could result into an unstable system. Since the algo ignores eye width and eye height of rank1 then if rank0 has slightly lower margin than rank1, after this algo both ranks will see drop in margins for eye height and eye width. EV reported shrinkage in WrT margin after this algo.

Solution
Create a wrapper function and use generic WriteVoltageCentering2D function for both LP4 and LP5 by assigning correct Rank and RankMask values for each tech. For LP4 rankloop will execute only once and RankMask is 0xFF.

Verified the feature and reviewed logs to check if MR14 and MR15 are programmed correctly per rank based on the results of this training

Hsd-es-id: 14011827769
Original commit date: Thu Jul 16 20:46:52 2020 -0700
Change-Id: I54db34331c3b3381c6536373e3051c34b2099e07
Original commit hash: e6c9006f703f775f47c24443ab2f519797d36ac4

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCommon.c
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/WriteTraining/MrcWriteDqDqs.c

================================================================================ 
Commit: 163b46a6e353d02c9f945ed9fcdd2d0582cad9ba 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:46:03 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 19:28:02 2020 +0000
Original commit date: Tue Jul 21 19:28:02 2020 +0000
Original commit hash: bed9bfd102aada8351b90ed071de992b2d4739c4

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 81a598160609ea004c6502c8bea273407deceffd 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:59 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl:[TGL][MRC][LP5] Maximum Frequency is set to 4200 as W/A for TGL Y board only

there's a fuse called MAX_DATA_RATE_AT_GEAR_1 which limits your PLL frequency (even for g2).  Because of complications with Lp4 this fuse was rashly set to 8 which corresponds to max G2 data rate of 4267MT/s.   The default boot frequency for Lp5 is currently set at 4400 which is fine from a Si perspective but fails on UP4

Hsd-es-id: 22010984326
Original commit date: Wed Jul 15 16:21:27 2020 -0700
Change-Id: I9834293124c830df1ed045b8bade358733eb062a
Original commit hash: e65c238bd21bca01d14445b78b6e933ae682d775

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/MiniBios/MEMORY/MrcSetup.c
TigerLakeBoardPkg/TigerLakeYBoards/Include/TigerLakeYBoardConfigPatchTable.h

================================================================================ 
Commit: 7639a986ad4724a1ea2935021ff78d28bad60974 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:56 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 18:52:00 2020 +0000
Original commit date: Tue Jul 21 18:52:00 2020 +0000
Original commit hash: 2d810f13265ddf967e6896e435e453373ea221a4

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: 0a413c6f7ce47ace35ec697961733f280f7ee91c 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:49 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 03:39:48 2020 +0000
Original commit date: Tue Jul 21 03:39:48 2020 +0000
Original commit hash: c4e501ec2b4589770c15f92b91d4920558aa8729

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: bc75b21fecdad79cbeaf19b2595fd208ce582965 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:45 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/MemoryInit:[TGL][MRC][LP5] Remove WrV UPM Limit code from Command Voltage Centering

MrcGetUpmPwrLimit function returns the UPM or PWR limit value for specified parameters. The PWR limit numbers are in this table MrcUpmPwrRetrainLimits. These numbers mostly come from EV.
MrcGetUpmPwrLimit is called several times during power training. The above mentioned code is executed during Command Voltage Centering and its checking Power limits for WrV which doesnt make sense.
EV suggested to remove this code from CmdV for all tech.

Hsd-es-id: 14011898756
Original commit date: Wed Jul 15 15:10:31 2020 -0700
Change-Id: Idd7516adb7d45513cacaa43397d869bf90699600
Original commit hash: 750f09b359c5c27badeedbdf0efacc803940d038

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCommandTraining.c

================================================================================ 
Commit: 002984b86c20ebe5e4b4025a47de7b37f0c220e3 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:41 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 01:45:57 2020 +0000
Original commit date: Tue Jul 21 01:45:57 2020 +0000
Original commit hash: 473a5c80404e5180f2cdf15d19eef5f0dd92ab69

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: a83bb41b317ba6715e9b0f6efe1fadd743f5386b 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:37 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl:[TGL][MRC][LP5] Changing default frequency for LP5 to 4800

Changing default frequency for LP5 to 4800

Hsd-es-id: 14012009437
Original commit date: Sun Jul 12 20:00:23 2020 -0700
Change-Id: I0d62e883c18d6b049fab5622a0affcef326daabd
Original commit hash: 6bcbd59640065491889fd87234040656a3e90f51

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Api/MrcGeneral.c

================================================================================ 
Commit: 4c2f7667e7798be7af0ffb240d7ec97c339d46e9 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:33 2020 -0700 
-------------------------------------------------------------------------------- 
Update MRC Release Notes and increment MRC build revision

Tue Jul 21 01:02:37 2020 +0000
Original commit date: Tue Jul 21 01:02:37 2020 +0000
Original commit hash: 10aae3a6707501c6ded0ce52425186c4ac69eade

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: d1d16b3568bff4c8277eee0b9e66c9478c47f2fd 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:30 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl: [TGL][MRC] Remove setting Center to the starting point of the sweep loof in case of failure in DQTimingCenterin1D
Issue:
  When we get a failure in DQTimeCentering1D and see zero margins (Left and Right) Center value is still set ot the start of sweep range
Root cause:
  Ther was a change
  SHA-1: fec5f0c9f1256a70d5f175d6b098c24a2d77d3de
  * ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl: MRC - TGL H Support, ICL merges, bug fixes, and code cleanup.
  Which is not present in ICL.
Change:
  Make Center value zero if left and right values are zeros

Hsd-es-id: 22010816759
Original commit date: Mon Jun 29 00:53:55 2020 -0700
Change-Id: I57584e743b0c65688382fac6cfef7a2f0aed37e8
Original commit hash: 6d17b5d3358bf808075692036257a6182568e165

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Services/MrcCommon.c

================================================================================ 
Commit: 0a1bd200ca9f9db117f8e3f1b29125efb811632a 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:25 2020 -0700 
-------------------------------------------------------------------------------- 
C1S/MemoryInit/Tgl: [TGL][MRC] Update MrcVersion.h and ReleaseNotes to 0.9.7.0

Updating MrcVersion.h and ReleaseNotes

Hsd-es-id: N/A
Original commit date: Mon Jul 20 09:50:19 2020 +0800
Change-Id: I20840881a1bc04b48129afa8111f3519051f3986
Original commit hash: ef15065a40efe142edefd6c214a3120092e7d9bb

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/MemoryInit/Tgl/LibraryPrivate/PeiMemoryInitLib/Source/Include/MrcVersion.h

================================================================================ 
Commit: c2c9052627eb1baf68e5eb1482ff9f6405f85c1f 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:18 2020 -0700 
-------------------------------------------------------------------------------- 
[TGL-H] BIOS needs to provide hard-coded DPin configuration

DPin function update.

Hsd-es-id: 22010773126
Original commit date: Tue Jul 14 17:51:42 2020 +0800
Change-Id: Idf62051311ab27d6f5e74d1ab817f8ce53176410
Original commit hash: 4f3f4a58333023ccc6ed2c2c78ffaa24f86ccde1

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/Tcss/LibraryPrivate/PeiDpInInitLib/PeiDpInInitLib.c
TigerLakeBoardPkg/Library/PeiBoardConfigLib/PeiBoardConfigLib.c
TigerLakeBoardPkg/TigerLakeHBoards/Library/BoardInitLib/Pei/BoardPchInitPreMemLib.c
TigerLakeBoardPkg/TigerLakeHBoards/Library/BoardInitLib/Pei/PeiInitPreMemLib.c
TigerLakeBoardPkg/TigerLakeHBoards/Library/BoardInitLib/Pei/PeiMultiBoardInitPreMemLib.inf
TigerLakePlatSamplePkg/Include/SetupVariable.h
TigerLakePlatSamplePkg/Setup/PlatformSetup.hfr

================================================================================ 
Commit: 80d210fa91afcd7a220953f9a7bebdde5c493701 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:11 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Sat Jul 25 09:57:26 2020 -0700
Change-Id: Ia2a914e160ab5692c050042ab7b6dd68a3534db2
Original commit hash: c1e24f0ecc597d544c5307d736eeb8324be6f072

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 8eb1b746f0bc69eca43c72cb19dccdcb300e6a06 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:08 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3306_00

Hsd-es-id: no sighting
Original commit date: Sat Jul 25 09:57:04 2020 -0700
Change-Id: I7d8c7147540f3a280fb752b965c660cc62aeddef
Original commit hash: 972e72c76e4dbd70c4912dd2aa6eb67588f6094c

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 1c7c9ce372f8740696e946b358924310a1226e53 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:04 2020 -0700 
-------------------------------------------------------------------------------- 
TigerLakePlatSamplePkg: Move platform debug state checks into a callback

The platform is said to be in a debug state if any of the following is true:
    - Using a sample part
    - Feature Control MSR lock is not set
    - Debug interface is enabled
    - SOC Configuration lock is not set (manufacturing mode)

If the platform is in a debug state, PcdFirmwareDebuggerInitialized is
set to TRUE and the Tcg2Dxe module will call
MeasureLaunchOfFirmwareDebugger ().

Prior to this change, the checks were executing before finalizing the
register configuration, thus incorrectly flagging the platform debug
state and breaking attestation of PCR 07.

To ensure that the registers being read have been properly configured at
the time the check is executed, the function has been moved from the
PlatformInitAdvancedPostMemEntryPoint () into a callback tied to the end
of the silicon initialization:
  - gFspSiliconInitDonePpiGuid for FSP builds
  - gEfiEndOfPeiSignalPpiGuid for EDK builds

Hsd-es-id: 14012041630
Original commit date: Fri Jul 24 12:29:24 2020 -0700
Change-Id: Ia1ace290afb211f8ea09f9d236b325449e87cedb
Original commit hash: 74863c64b374fe9ba999fe3a2f2acbb67334b030

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/PlatformInitAdvanced/PlatformInitAdvancedPei/PlatformInitAdvancedPostMem.c
TigerLakePlatSamplePkg/PlatformInitAdvanced/PlatformInitAdvancedPei/PlatformInitAdvancedPostMemFsp.inf

================================================================================ 
Commit: da6e228706ac57ec3dab711f0234e2d409b06f00 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:45:00 2020 -0700 
-------------------------------------------------------------------------------- 
[Title]
TGL-H PO [BIOS]:After disabling DMI Gen3 Eq Phase 2,  MMIO register offset is mismatching.

[Resolution]
For TGL-H, this setup option are not used for DMI and hence suppressing it.

[Impacted Platform]
TGL-H

Hsd-es-id: 16011257476
Original commit date: Wed Jul 22 13:11:52 2020 +0530
Change-Id: I147f8f5276350d960f5dceed92e740ba5aa47d23
Original commit hash: 48b50e908dcbdaa89839c9f62da3b54a7f450cb5

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/Setup/SaSetup.hfr

================================================================================ 
Commit: 5ad0f932c33b82f73a73ba6b9be87d980a1e589e 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:57 2020 -0700 
-------------------------------------------------------------------------------- 
SsdtRtd3: PS0 and PS3 methods missing for GBE

SUT fails to achieve S0ix steadily with LAN enabled in BIOS.
Disabling LAN in windows cause LAN do go to D3 but not to powergate - blocking S0ix entry

Hsd-es-id: 14012030930
Original commit date: Thu Jul 16 12:47:11 2020 -0700
Change-Id: I3a4b47586a4d528f902ffc9ca709e20cc8273ab7
Original commit hash: 17aa7d4183bfbbbcdac173f66c63e846239a8455

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/Acpi/AcpiTables/SsdtRtd3/TglHRvpRtd3.asl

================================================================================ 
Commit: a7ad1373fb177c33128786c0e9eb17f3e1e1a57a 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:54 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Fri Jul 24 10:32:14 2020 -0700
Change-Id: If0851a662e13a5f7b983b3f1f3d8cd69e93eea2c
Original commit hash: 7dedb51549b65aa6dea8af463e098e76a0b4fd5d

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 4c7528380d210fd6291a7f5f408b485952689dcd 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:51 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3305_00

Hsd-es-id: no sighting
Original commit date: Fri Jul 24 10:31:45 2020 -0700
Change-Id: I037174171147b2d902b574494b4e1d4db50c7efb
Original commit hash: fdf281913d0347eda077fc2d8a5905a74a4b47c7

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: 3234d1c24368e7b36faf1a8bd05f009c25fbd67f 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:48 2020 -0700 
-------------------------------------------------------------------------------- 
Updated Microcode patch for P0 Unified (uCode+Punit) Production Patch 0x30

Hsd-es-id: 22011169393
Original commit date: Thu Jul 23 12:01:37 2020 -0700
Change-Id: Ifbc3a2c2dcbeba5bf703b0df03ed1e1bc758920e
Original commit hash: 3548e34975f0d7d3123a75489ef70448cede6158

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BoardPkg.fdf

================================================================================ 
Commit: 23f787824d86d0e0aef7fb753b2ebef47ec3c914 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:45 2020 -0700 
-------------------------------------------------------------------------------- 
ClientOneSiliconPkg: Print global reset reason

Added global reset reason registers print for easier debug.

Hsd-es-id: 18012328920
Original commit date: Thu Jul 23 12:33:36 2020 +0200
Change-Id: I858b56fd1594d9495209e117bfcba1862156cef9
Original commit hash: d4e2caa0286d0cb9eb1e527feb4de8f6482b0eb2

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/Include/Register/PmcRegs.h
ClientOneSiliconPkg/IpBlock/Pmc/IncludePrivate/Library/PmcPrivateLib.h
ClientOneSiliconPkg/IpBlock/Pmc/LibraryPrivate/PeiDxeSmmPmcPrivateLib/PmcPrivateLib.c
ClientOneSiliconPkg/Pch/LibraryPrivate/PeiPchInitLib/PchInitPreMem.c

================================================================================ 
Commit: 33ec86edc644291090ef9f31c9313df205220bc3 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:42 2020 -0700 
-------------------------------------------------------------------------------- 
[TGL/ME] Unique Platform Id-AMT-DisableEnable - take#2

Issue: Enable/disable Upid State and Upid OS Control State don't work.
Resolution: Add SetUpidFeatureState and SetUpidOsControlState command in MeSetup.c
Impacted: All TGL projects.

Hsd-es-id: 14011554022
Original commit date: Thu Jul 23 21:20:57 2020 +0800
Change-Id: I738bab6f5b9f379e7bfeed9a6df50b9b6939c88b
Original commit hash: 6fd8b3f6c89bf10a5c418ed027da9473281189ab

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/IpBlock/Me/Library/DxeMeLib/HeciMsgDxeLib.c
TigerLakePlatSamplePkg/Setup/MeSetup.c
TigerLakePlatSamplePkg/Setup/MeSetup.hfr

================================================================================ 
Commit: cd8d8485f78bfab5c4eec6e59057480ee9ab9a14 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:38 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit DailyUpdate_FSP/RC TGLMaster

Hsd-es-id: no sighting
Original commit date: Thu Jul 23 10:55:42 2020 -0700
Change-Id: Ic201f3a1d7279012136df8464cb1cef567e8a25e
Original commit hash: 4485dd642aa50a0155f6c228d5f9e5260689c3cf

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeFspPkg/TigerLakeFspPkg.dec

================================================================================ 
Commit: 8e84d7cc9e8c18b6bd0b3e21b82d56488644420d 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:35 2020 -0700 
-------------------------------------------------------------------------------- 
[TeamCity] TGL Auto-Commit BIOS ID update CI BIOS Version to 3304_00

Hsd-es-id: no sighting
Original commit date: Thu Jul 23 10:54:42 2020 -0700
Change-Id: Ia716f55cff418c908be25d351c54ec8e0e3ec8be
Original commit hash: 36325f6c2471eafa490dcaecca483d8c18d32370

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/BiosId.env

================================================================================ 
Commit: cb7bf3efdda527cd51cd568063ec3783d147a097 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:32 2020 -0700 
-------------------------------------------------------------------------------- 
Chasm Falls: add bios and capsule size compare when capsule update happens

Since gen2, resiliency bios have diffrent size with normal bios, so if
use a resiliency bios to update an non-resiliency bios, there will have
unexpected situation, so add this patch to stop the update if the capsule
bios size is different with SPI bios size.

Hsd-es-id: 16011469491
Original commit date: Wed Jul 22 14:49:39 2020 +0800
Change-Id: I76e010031c043999e275a9a4f97b9634d058cacf
Original commit hash: fca6ac6815e996687bba247c2b2531601b18b0cc

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Library/BiosUpdateHelpersLib/BiosUpdateHelpersLib.c
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Library/BiosUpdateHelpersLib/BiosUpdateHelpersLib.inf

================================================================================ 
Commit: 319dd7f7fa2a22caed31ed72b6f505609a80d5e2 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:27 2020 -0700 
-------------------------------------------------------------------------------- 
TigerLakePlatSamplePkg/CapsuleUpdate: After successful BIOS Resiliency Windows Capsule update is loading on every boot

Scenario:
BIOS is upgraded from N to N+1 successfully but somehow N+1 is not bootable.
Hence Resiliency feature is triggered to rollback BIOS to N.
After BIOS is rollback to N and boot into Windows,
OS detects that LastAttemptStatus in ESRT is success (since the update itself was successful)
while the current FwVersion N does not match to LastAttemptVersion N+1.
As a result Windows keeps trying to finish the intended Capsule update.

Solutions:
1. Resiliency driver reports an error in LastAttemptStatus (LAST_ATTEMPT_STATUS_ERROR_INVALID_FORMAT)
   after BIOS rollback to indicate that the update is not successful since system is not bootable after BIOS upgrade.
   So that Windows will stop trying Capsule update again.
2. The corresponding LastAttemptStatus to be patched is identified by referring to LastCapsule variable.
3. In post-update phase (progress is UpdatingResiliency), BootMode is still set as BOOT_ON_FLASH_UPDATE
   in order to keep BIOS flash capability for IBB backup.
   However the boot mode BOOT_ON_FLASH_UPDATE causes LastCapsule variable to be deleted in DxeCapsuleLibConstructor
   before it can be referred by Resiliency driver.
   So further backup LastCapsule variable in this case to have a chance figuring out which FMP FW (BIOS, BtGACM or uCode)
   is the last updated one and the corresponding LastAttemptStatus to be hacked.

Hsd-es-id: 16011400764
Original commit date: Wed Jul 22 06:10:55 2020 +0800
Change-Id: Icacef4b48c2145490cbb0f27c7dbf4e39dd1c7f0
Original commit hash: d8a7f62136d3ed1f4bb82c4400f0ec84b399095f

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Include/Guid/SysFwUpdateProgress.h
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Library/SeamlessRecoverySupportLib/SeamlessRecoverySupportLib.inf
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Resiliency/Dxe/ResiliencyDxe.c
TigerLakePlatSamplePkg/Features/CapsuleUpdate/Resiliency/Dxe/ResiliencyDxe.inf

================================================================================ 
Commit: 95fa516c7a87850c268e970c69ef8996e49e2c78 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:23 2020 -0700 
-------------------------------------------------------------------------------- 
Remove Gfx Gen9 Libs as they are not used.

Hsd-es-id: 16011454125
Original commit date: Fri Jul 17 18:59:59 2020 +0530
Change-Id: I3047d5d889edd71979c78228d7217f3ae34da91e
Original commit hash: f85a1824fa201fb5c158026d86ff1b0aeb43314b

-------------------------------------------------------------------------------- 
[Changed Files]
ClientOneSiliconPkg/Include/ConfigBlock/Graphics/Gen9/GraphicsConfig.h
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiDisplayInitLibGen9/PeiDisplayInitLib.c
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiDisplayInitLibGen9/PeiDisplayInitLib.inf
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsInitLibGen9/AdditionalDisableSteps.c
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsInitLibGen9/PeiGraphicsInitLib.c
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsInitLibGen9/PeiGraphicsInitLib.inf
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsInitLibGen9/PeiGraphicsPmInit.c
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsPolicyLibGen9/PeiGraphicsPolicyLib.c
ClientOneSiliconPkg/IpBlock/Graphics/LibraryPrivate/PeiGraphicsPolicyLibGen9/PeiGraphicsPolicyLib.inf

================================================================================ 
Commit: 23959eb6d3995e836c0e73bc5efe5884fbc5445c 
Author: ClientSysFWGit <clientsysfwgit@intel.com> 
Date: Fri Jul 31 13:44:18 2020 -0700 
-------------------------------------------------------------------------------- 
[TGL-H]VMD RTD3cold support

Added VMD RTD3 support

Hsd-es-id: 14011051937
Original commit date: Wed Jul 22 10:18:15 2020 -0700
Change-Id: Ic01299c847f9b152765349e9e6ea860271475238
Original commit hash: 530f2929c8ea9bc4111476a35cf659d7cf40cf4e

-------------------------------------------------------------------------------- 
[Changed Files]
TigerLakeBoardPkg/Acpi/AcpiTables/SsdtRtd3/Rtd3Vmd.asl
TigerLakeBoardPkg/Acpi/AcpiTables/SsdtRtd3/TglHRvpRtd3.asl
