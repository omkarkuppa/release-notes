*********************************************************************************
Commit: d5e3bdd318d19909f37886b656555e0b21825695 
*********************************************************************************

[PlatformPkg]

  Revert "[CFL] Update BIOS ID and SI version to 7.x.77.00"
  
  Hsd-es-id: 16018648307
  Change-Id: I01574586390a1f49e30bfbc4982eadc98d9505b7
  Original commit hash: 70e06f02f535395e8b2a80d7493c6ca74dc543bd
  
  CannonLakePlatSamplePkg/Tools/GenBiosId/BiosId.env
  CannonLakeSiliconPkg/SiPkg.dec
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: revert

*********************************************************************************
Commit: 84770b9dc048276a38d06e3c30d327e554bcaecc 
*********************************************************************************

[PlatformPkg]

  [CFL][CVE-2022-33894]Insecure handling of "CpuSmm" NVRAM variable
  
  [Issue/Feature Description]
  A security researcher reported a weakness with the NVRAM variable "CpuSmm".
  UEFI implementations do not correctly protect and validate information contained in the 'CpuSmm' UEFI variable.
  
  This variable can be overwritten using operating system APIs or UEFI shell.
  By tampering with this variable, SW attacker can disable SMM protection mechanisms (e.g., CpuSmmCodeAccessCheck).
  
  [Resolution]
  Set the attributes NV+BS for the CpuSmm NVRAM variable and do not include the RT attribute.
  It prevents this variable from being tampered with in runtime.
  
  Package/Module:CannonLakePlatSamplePkg/PlatformInitDxe
  
  [Impacted Platform]
  
  Hsd-es-id: 15011592487
  Change-Id: I4b45fca225e007cff3a276ee25494e824f78a2f9
  Original commit hash: 959d726f13b6875f3c7f2554b1373c6e29fcc24d
  
  CannonLakePlatSamplePkg/PlatformInit/PlatformInitDxe/PlatformInitDxe.c
  CannonLakePlatSamplePkg/PlatformInit/PlatformInitDxe/PlatformInitDxe.inf
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: CVE
  --Commit Message Contains Key Word: security

*********************************************************************************
Commit: b01948f8f2c0c247b19f90eba83ddbd55a63216c 
*********************************************************************************

[PlatformPkg], [CPU]

  Revert "[CFL][PSIRT]Insecure handling of "CpuSmm" NVRAM variable"
  
  This reverts commit fac9ffb53628ff2410522be0b9a999ce2a6a778a.
  
  Hsd-es-id: 15011592487
  Original commit hash: 398aa20c09c11dfc9b98c9bfb35df38d7f103bf9
  
  CannonLakePlatSamplePkg/Include/CpuSmm.h
  CannonLakePlatSamplePkg/Include/SetupVariable.h
  CannonLakePlatSamplePkg/Library/DxePolicyUpdateLib/DxeCpuPolicyUpdate.c
  CannonLakePlatSamplePkg/PlatformInit/PolicyInitDxe/PolicyInitDxe.c
  CannonLakePlatSamplePkg/PlatformInit/PolicyInitDxe/PolicyInitDxe.inf
  CannonLakePlatSamplePkg/PlatformPkg.dec
  CannonLakePlatSamplePkg/PlatformPkg.dsc
  CannonLakePlatSamplePkg/Setup/Advanced.vfr
  CannonLakePlatSamplePkg/Setup/CpuSetup.hfr
  CannonLakePlatSamplePkg/Setup/DebugSetup.hfr
  CannonLakePlatSamplePkg/Setup/HiiConfigAccess.c
  CannonLakePlatSamplePkg/Setup/InitStringList.h
  CannonLakePlatSamplePkg/Setup/SetupId.h
  CannonLakeSiliconPkg/Cpu/Include/Protocol/CpuPolicyProtocol.h
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeatures.h
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.c
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.inf
  CannonLakeSiliconPkg/SiPkg.dec
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: revert
  --Commit Message Contains Key Word: psirt

*********************************************************************************
Commit: 5e3227e6cfc5a7ffa73fd81d24fe7427a0284e71 
*********************************************************************************

[CPU]

  Revert "[CFL][PSIRT]Insecure handling of "CpuSmm" NVRAM variable - Part 2"
  
  This reverts commit 16b20c303fc2a948571faa77f9a3fd7d51dbbab5.
  
  Hsd-es-id: 15011592487
  Original commit hash: da04f6ec7c71373bc8dd5157200b75613452eca8
  
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/SmmCpuFeaturesLib.inf
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: revert
  --Commit Message Contains Key Word: psirt

*********************************************************************************
Commit: 4504e6b44a46ce1ac8881270684eaf11c86a9bf6 
*********************************************************************************

[PlatformPkg]

  Revert "[CFL] Update BIOS ID and SI version to 7.x.77.00"
  
  Hsd-es-id: 16018648307
  Change-Id: I97e0e379145f08ae75a44b82f947630a020b99ca
  Original commit hash: b33549af6bb3b1b37e1a08c07674b73c1a1bce1a
  
  CannonLakePlatSamplePkg/Tools/GenBiosId/BiosId.env
  CannonLakeSiliconPkg/SiPkg.dec
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: revert

*********************************************************************************
Commit: 82e013f1a7062e1bad9e20d0d95fe202f218f1ff 
*********************************************************************************

[CPU]

  [CFL/CNL]: [CVE-2022-38087] Need RSB
  mitigation in SMM (SmmCpuFeaturesLib and PiSmmCpuDxeSmm)
  
  [Issue Description]
  To avoid interfering with non-SMM usage of the retpoline technique
  
  [Resolution]
  Adding Return Stack Buffer(RSB) stuffing logic before returning from SMM (RSM instruction)
  to avoid interfering with non-SMM usage of the retpoline technique.
  
  Package/Module:
  CannonLakeSiliconPkg
  
  [Impacted Platform]
  CFL/CNL
  
  Hsd-es-id: 22015686554
  Change-Id: Idd76f21240cfecdcb43d5ba3503688ef3bcfb8d0
  Original commit hash: 56e5223ca2106945c1e892f8f9557bace85ebe0b
  
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/X64/SmiEntry.nasm
  CannonLakeSiliconPkg/Cpu/Library/SmmCpuFeaturesLib/X64/StuffRsb.inc
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/Ia32/SmiEntry.nasm
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/Ia32/SmmInit.nasm
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/Ia32/StuffRsb.inc
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/X64/SmiEntry.nasm
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/X64/SmmInit.nasm
  ClientCommonPkg/Override/UefiCpuPkg/PiSmmCpuDxeSmm/X64/StuffRsb.inc
  

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Potential Errors Below:

  --Commit Message Contains Key Word: CVE

################################################################################

Report Summary: Backstop found 6 suspect commits for review 

Warnings Found:
  Commit: d5e3bdd    --Commit Message Contains Key Word: revert
  Commit: 84770b9    --Commit Message Contains Key Word: CVE
  Commit: 84770b9    --Commit Message Contains Key Word: security
  Commit: b01948f    --Commit Message Contains Key Word: revert
  Commit: b01948f    --Commit Message Contains Key Word: psirt
  Commit: 5e3227e    --Commit Message Contains Key Word: revert
  Commit: 5e3227e    --Commit Message Contains Key Word: psirt
  Commit: 4504e6b    --Commit Message Contains Key Word: revert
  Commit: 82e013f    --Commit Message Contains Key Word: CVE
